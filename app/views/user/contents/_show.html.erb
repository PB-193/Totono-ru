<div class="col-md-7 mb-3">
  <div class="card">
    <div class="card-header">
      <h5 class="card-title">レビュー詳細</h5>
    </div>
    <div class="card-body">
      <table class="table pr-md">
        <tbody>
           <tr>
            <th>投稿日</th>
            <td><%= @content.created_at.strftime("%Y年%m月%d日") %></td>
          </tr>
          <tr>
            <th>ユーザ名</th>
            <td><%= @content.user.name %></td>
          </tr>
          <tr>
            <th>訪問日</th>
            <% if @content.visit_day.present? %>
              <td><%= @content.visit_day.strftime("%Y年%m月%d日") %></td>
            <% else %>
              <td></td>
            <% end %>
          </tr>
          <tr>
            <th>タイトル</th>
            <td><%= @content.title %></td>
          </tr>
          <tr>
            <th>タグ一覧</th>
            <td>
              <% @content.tags.each do |tag| %>
                <%= link_to tag.name, searches_path(tag_id: tag.id), class: "badge badge-primary" %>
              <% end %>
            </td>
          </tr>
          <tr>
            <th>サウナ施設</th>
            <td>
              <%= link_to @content.spot, "https://www.google.com/maps/search/?api=1&query=#{CGI.escape(@content.spot)}", target: "_blank" %>
            </td>
          <tr>
            <th>ととのい度</th>
            <td><%= render "user/contents/static_rate", content: content %></td>
          </tr>
        </tbody>
      </table>
      <table class="table table-main">
        <tbody>
          <tr>
            <!--本文を改行込みで表示-->
            <th>本文</th>
            <td>
              <% if @content.text.length >= 9 %>
                <%= safe_join(@content.text.split("\n"), tag(:br)) %>
              <% else %>
                <%= @content.text %>
              <% end %>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div class="card mb-3" style="max-width: 600px;">
        <div class="row no-gutters">
          <div class="col-md-4">
            <% if content.review_image.attached? %>
              <!-- 画像をクリックした際のモーダル表示部分 -->
              <div class="review_image_modal" id="reviewImageModal">
                <img id="modalImage">
              </div>
              <%= image_tag content.review_image, class: "review_image clickable" %>
            <% else %>
              <p><%= image_tag 'no_image', class: "review_image" %></p>
            <% end %>
          </div>
          <div class="col-md-8" id="imageText">
            <div class="card-body" >
              <h5 class="card-title">写真をクリックすると拡大します。<br>画像がない場合は拡大しません。</h5>
            </div>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</div>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    const reviewImage = document.querySelector(".review_image");
    const modal = document.getElementById("reviewImageModal");
    const modalImage = document.getElementById("modalImage");
    const imageCaption = document.getElementById("imageCaption");

    reviewImage.addEventListener("click", function () {
      modal.style.display = "flex";
      modalImage.src = this.src;
      reviewImage.style.display = "none"; // 元の画像を非表示にする
      imageText.style.display = "none"; // textを非表示にする
    });

    modal.addEventListener("click", function () {
      modal.style.display = "none";
      reviewImage.style.display = "block"; // 元の画像を再表示する
      imageText.style.display = "block"; // textを再表示する
    });
  });
</script>